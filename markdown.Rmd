---
title: "Pruebas y simulaciones. Apendice leos Barajas 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### **Simulación de los datos**

Vamos a simular datos para:

* 4 estados 
* 50 series
* 500 tiempos
* 3 variables (los tres ejes de acelerómetros)

$$X_{si}=(X_{1i},X_{2i},X_{3i}) \sim NM_3(\mu_i,\Sigma_i)$$
con $i=\{1,2,3,4\}$ (correspondiente a cada estado)

#### **LOOCV**


Leave one out cross-validation. 

1. Se deja una de las series de tiempo afuera (sea $k$)
2. Se estiman los parámetros del modelo con las 49 restantes (medias y matrices de covarianza de las NMV, matriz de traslación y  probabilidades iniciales de cada estado)
3. A partir de esos parámetros se calcula la serie de tiempos más probable para $k$ a partir del *algortimo recursivo de Viterbi*
4. Se estima el error de predicción como la proporción de estados mal estimados sobre el total (sobre todos las series de tiempo) 